"""Protein trap image scores.

Miriam was incharge of running the protein traps and summarizing several scores
results. She emailed me a excel sheet whose contents are just pated in ths
script. I added the FBgns by hand.

"""

from io import StringIO

import pandas as pd

oname = snakemake.output[0]

# This data is from a spreadsheet that Miriam gave me. I had to add on FBgns
dat = """
FBgn,gene_symbol,Spermatogonia,Early 1ยบ Spermatocytes,Mid 1ยบ Spermatocytes,Late 1ยบ Spermatocytes,Cyst Cells,Pigment Cells,Terminal Epithelium,Hub
FBgn0026573,ADD1,1.25,3.75,6.25,6.875,0,0,0,0
FBgn0012037,Ance,1.25,1.875,3.333333333,3.75,4.166666667,0,0,0
FBgn0011206,bol,0,0.625,2.5,6.875,0,0,0,0
FBgn0015609,CadN,1.875,1.875,4.166666667,5,3.125,1.666666667,1.875,2.5
FBgn0015609,CadN,1.875,1.875,2.5,1.666666667,3.125,0.625,0.625,2.5
FBgn0015609,CadN,0.833333333,0.833333333,1.666666667,1.25,2.5,1.25,1.25,1.25
FBgn0032771,CG17349,1.666666667,2.5,2.5,2.5,2.5,0,0,2.5
FBgn0264494,CG17646,0.625,1.875,1.875,2.5,2.5,0,0.625,0
FBgn0031518,CG3277,1.25,1.25,1.666666667,1.666666667,2.5,0.833333333,1.25,1.875
FBgn0259221,CG42321,1.25,1.666666667,1.666666667,1.666666667,2.5,0.625,0,1.25
FBgn0039754,CG9747,0.833333333,2.5,3.125,2.5,1.875,1.25,1.25,1.25
FBgn0027598,cindr,1.666666667,2.5,2.5,2.5,3.333333333,3.75,4.166666667,3.333333333
FBgn0026533,Dek,7.5,7.5,7.5,7.5,3.75,7.5,3.75,7.5
FBgn0087008,e(y)3,6.25,6.25,6.25,5,3.125,5.833333333,3.75,6.25
FBgn0051158,Efa6,2.5,3.333333333,3.333333333,3.333333333,5,,5.833333333,
FBgn0051158,Efa6,2.5,4.375,4.375,4.375,2.5,1.25,1.25,3.125
FBgn0000636,Fas3,0.625,0.625,1.25,1.25,1.25,0,5.833333333,7.5
FBgn0000636,Fas3,0,1.25,0,1.25,1.25,1.25,4.375,5.625
FBgn0013469,klu,1.666666667,3.333333333,3.333333333,3.333333333,4.166666667,2.5,1.666666667,1.25
FBgn0034282,Mapmodulin,5.833333333,5.833333333,6.666666667,4.166666667,4.166666667,4.166666667,5,2.5
FBgn0265487,mbl,0.625,2.5,6.25,4.375,1.666666667,3.75,6.25,0.625
FBgn0262519,Mi-2,0,1.25,1.25,1.25,2.5,0,0,0
FBgn0030505,NFAT,0.833333333,0.833333333,1.666666667,1.875,2.5,4.166666667,0,0.625
FBgn0002945,nkd,1.25,2.5,3.333333333,1.666666667,1.875,0.833333333,1.25,1.666666667
FBgn0050418,nord,0.625,1.875,1.875,1.875,3.75,0.625,7.5,0
FBgn0264975,Nrg,3.75,1.875,1.875,1.875,5.625,3.333333333,6.875,6.25
FBgn0261885,osa,6.25,5.625,5.625,4.375,3.125,6.666666667,6.25,4.375
FBgn0039044,p53,4.375,3.125,1.875,0,1.875,0.625,0.625,0.625
FBgn0030520,Pdcd4,7.5,6.875,6.25,5.625,6.875,2.5,7.5,3.75
FBgn0085370,Pde11,0,0,0,0,0.625,0,0,0
FBgn0264953,Piezo,1.875,0,0,1.25,3.333333333,2.5,5.625,1.875
FBgn0000416,Sap-r,3.125,3.75,3.75,5,5.833333333,2.5,6.875,0
FBgn0003475,spir,0,0.625,1.25,1.25,0.833333333,0,0,0
FBgn0026370,SRPK,5.625,6.25,6.875,6.875,3.125,0.625,0.625,0.833333333
FBgn0041182,Tep2,1.25,1.25,1.875,2.5,4.375,6.25,1.25,0.833333333
FBgn0004885,tok,0.625,1.666666667,1.875,1.875,0.833333333,0,1.875,0.625
FBgn0010473,tutl,0,0.625,0.625,0.625,0.625,0,1.25,0
FBgn0011725,twin,0.833333333,0.833333333,0.833333333,0.833333333,0,0,0,0
"""

df = pd.read_csv(StringIO(dat), sep=',')
df.drop('Hub', axis=1, inplace=True)


# Some of the genes had multile values. I am going to take the mean so all
# genes have a single row.
agg = df.groupby(['FBgn', 'gene_symbol']).mean()

agg.to_parquet(oname)
